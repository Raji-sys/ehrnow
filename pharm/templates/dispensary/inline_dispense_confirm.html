<!-- inline_dispense_confirm.html -->
<tr class="text-xs bg-amber-100">
    <td colspan="9" class="p-4">
        <div class="text-center">
            {% if can_dispense %}
                <p class="mb-4">
                    Confirm dispensing {{ prescription.drug.name }} 
                    ({{ prescription.quantity }} units) to {{ prescription.patient }}?
                </p>
                <div class="space-x-4">
                    <button class="bg-green-500 text-white px-4 py-2 rounded"
                            hx-post="{% url 'pharm:inline_dispense' prescription.id %}"
                            hx-target="closest tr"
                            hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
                        Confirm Dispense
                    </button>
                    <button class="bg-gray-500 text-white px-4 py-2 rounded"
                            hx-get="{% url 'pharm:prescription_list_row' prescription.id %}"
                            hx-target="closest tr">
                        Cancel
                    </button>
                </div>
            {% else %}
                <div class="text-red-500 mb-4">
                    Cannot dispense: {{ message }}
                </div>
                <button class="bg-gray-500 text-white px-4 py-2 rounded"
                        hx-get="{% url 'pharm:prescription_list_row' prescription.id %}"
                        hx-target="closest tr">
                    Back
                </button>
            {% endif %}
        </div>
    </td>
</tr>